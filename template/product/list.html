{% load static %}
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gallery Collab ğŸ¨</title>
    <link rel="stylesheet" href="{% static 'css/index.css' %}">
    <link rel="stylesheet" href="{% static 'css/fade.css' %}">
</head>
<style>
{#  æˆ‘ä¹Ÿä¸çŸ¥é“ä¸ºä»€ä¹ˆè¿™ä¸ªé“¾æ¥ä¸è¿‡æ¥ï¼Œåªå¥½æ”¾åœ¨htmlé‡Œé¢å¾—äº†  #}
    .floating-avatar {
        position: fixed;
        top: 20px;
        right: 20px;
        z-index: 1000;
        cursor: pointer;
        transition: transform 0.2s ease-in-out;
    }

    .floating-avatar:hover {
        transform: scale(1.05);
    }

    .floating-avatar {
        position: fixed;
        top: 20px;
        right: 20px;
        z-index: 1000;
        cursor: pointer;
        transition: transform 0.2s ease-in-out;
    }

    .floating-avatar:hover {
        transform: scale(1.05);
    }

    .avatar-circle {
        width: 48px;
        height: 48px;
        border-radius: 50%;
        overflow: hidden;
        background-color: #f0f0f0;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        display: flex;
        align-items: center;
        justify-content: center;
    }

    .user-avatar {
        width: 100%;
        height: 100%;
        object-fit: cover;
        display: block;
    }
</style>

<div class="floating-avatar">
    <a href="{% url 'user_profile' %}">
        <div class="avatar-circle">
            <img src="{{ user.avatar.url|default:'/media/accounts/default.png' }}"
                 alt="{{ user.username }}"
                 class="user-avatar">
        </div>
    </a>
</div>

<body>
<div class="shell" id="shell">
    <div class="header">
        <h2 class="title">Gallery Collab ğŸ¨</h2>
        <h3 class="subtitle">Welcome Back</h3>
    </div>
    <div class="timeline">
        {% for p in products %}
            {% if p.visible or user.is_authenticated %}
                <div class="item" data-text="{{ p.name }}">
                    <div class="content">
                        <a href="{% url 'products_detail' p.id %}">
                            <img src="{{ p.image.url }}" alt="" class="img">
                        </a>
                        <h2 class="content-title">{{ p.Shooting_Date|date:"Y-m-d" }}</h2>
                        <p class="content-desc">
                            {{ p.description }}
                        </p>
                    </div>
                </div>
            {% endif %}
        {% endfor %}
    </div>

    <div style="text-align: center; margin-top: 2rem; font-size: 0.9rem; background-color: transparent;">
        <p class="cpr"> Â© 2024 - 2025 â™¥ Haruko386 â™¥</p>
    </div>
</div>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
{#äº’åŠ¨æ #}


<script>
    (function ($) {
        $.fn.timeline = function () {
            var selectors = {
                id: $(this),
                item: $(this).find(".item"),
                activeClass: "item--active",
                img: ".img"
            };
            // å°†ç¬¬ä¸€ä¸ªæ—¶é—´è½´é¡¹ç›®æ¿€æ´»ï¼Œå¹¶è®¾ç½®æ—¶é—´è½´èƒŒæ™¯å›¾ç‰‡ä¸ºç¬¬ä¸€ä¸ªé¡¹ç›®çš„å›¾ç‰‡
            selectors.item.eq(0).addClass(selectors.activeClass);
            selectors.id.css(
                "background-image",
                "url(" +
                selectors.item.first()
                    .find(selectors.img)
                    .attr("src") +
                ")"
            );
            // è·å–æ—¶é—´è½´é¡¹ç›®çš„æ€»æ•°
            var itemLength = selectors.item.length;
            // å½“é¡µé¢æ»šåŠ¨æ—¶ï¼Œè§¦å‘æ»šåŠ¨äº‹ä»¶
            $(window).scroll(function () {
                var max, min;
                // è·å–é¡µé¢æ»šåŠ¨çš„è·ç¦»
                var pos = $(this).scrollTop();
                // æ·»åŠ ä¸€ä¸ªæå‰é‡ï¼Œè®©åˆ‡æ¢åœ¨å…ƒç´ è¿›å…¥è§†çª—å‰å°±å‘ç”Ÿ
                var earlyOffset = $(window).height() * 0.35; // è§†çª—é«˜åº¦çš„35%ä½œä¸ºæå‰é‡

                selectors.item.each(function (i) {
                    // è·å–å½“å‰æ—¶é—´è½´é¡¹ç›®çš„æœ€å°å’Œæœ€å¤§é«˜åº¦
                    min = $(this).offset().top;
                    max = $(this).height() + $(this).offset().top;
                    var that = $(this);

                    // å¦‚æœæ»šåŠ¨åˆ°æœ€åä¸€ä¸ªé¡¹ç›®ï¼Œå¹¶ä¸”è¶…è¿‡äº†å½“å‰é¡¹ç›®é«˜åº¦çš„ä¸€åŠï¼Œ
                    // åˆ™å°†æœ€åä¸€ä¸ªé¡¹ç›®è®¾ç½®ä¸ºæ¿€æ´»çŠ¶æ€ï¼Œå¹¶è®¾ç½®èƒŒæ™¯å›¾ç‰‡ä¸ºæœ€åä¸€ä¸ªé¡¹ç›®çš„å›¾ç‰‡
                    if (i === itemLength - 2 && pos > min + $(this).height() / 2) {
                        selectors.item.removeClass(selectors.activeClass);
                        selectors.id.css(
                            "background-image",
                            "url(" +
                            selectors.item.last()
                                .find(selectors.img)
                                .attr("src") +
                            ")"
                        );
                        selectors.item.last().addClass(selectors.activeClass);
                    }
                    // ä¿®æ”¹æ¡ä»¶ï¼šå½“æ»šåŠ¨ä½ç½®æ¥è¿‘å…ƒç´ é¡¶éƒ¨ï¼ˆæå‰earlyOffsetåƒç´ ï¼‰æ—¶å°±åˆ‡æ¢
                    else if (pos <= max - 10 && pos >= min - earlyOffset) {
                        selectors.id.css(
                            "background-image",
                            "url(" +
                            $(this)
                                .find(selectors.img)
                                .attr("src") +
                            ")"
                        );
                        selectors.item.removeClass(selectors.activeClass);
                        $(this).addClass(selectors.activeClass);
                    }
                });
            });
        };
    })(jQuery);

    $("#shell").timeline();
</script>
<script>
    document.addEventListener('DOMContentLoaded', function () {
        const floatingButton = document.getElementById('floatingButton');
        const floatingMenu = document.getElementById('floatingMenu');
        const floatingIcon = floatingButton.querySelector('.floating-icon');

        let isMenuOpen = false;

        floatingButton.addEventListener('click', function () {
            isMenuOpen = !isMenuOpen;

            if (isMenuOpen) {
                floatingMenu.classList.add('active');
                floatingIcon.textContent = 'âœ•'; // æˆ–è€…ä½¿ç”¨ â†‘
                floatingIcon.style.transform = 'rotate(90deg)';
            } else {
                floatingMenu.classList.remove('active');
                floatingIcon.textContent = 'â˜°';
                floatingIcon.style.transform = 'rotate(0)';
            }
        });

        // ç‚¹å‡»é¡µé¢å…¶ä»–åœ°æ–¹å…³é—­èœå•
        document.addEventListener('click', function (e) {
            if (!floatingButton.contains(e.target) && !floatingMenu.contains(e.target)) {
                floatingMenu.classList.remove('active');
                floatingIcon.textContent = 'â˜°';
                floatingIcon.style.transform = 'rotate(0)';
                isMenuOpen = false;
            }
        });
    });
</script>
<script>
    // é¡µé¢æ·¡å…¥å‡½æ•°
    function fadeIn() {
        document.body.style.opacity = 1;
    }

    // é¡µé¢åŠ è½½å®Œæˆï¼ˆé¦–æ¬¡è¿›å…¥ï¼‰
    document.addEventListener("DOMContentLoaded", function () {
        fadeIn(); // æ‰§è¡Œæ·¡å…¥åŠ¨ç”»

        const links = document.querySelectorAll("a");

        links.forEach(function (link) {
            const href = link.getAttribute("href");

            // æ’é™¤é”šç‚¹ã€JSé“¾æ¥ã€æ–°æ ‡ç­¾é¡µç­‰æƒ…å†µ
            if (
                href &&
                !href.startsWith("#") &&
                !href.startsWith("javascript:") &&
                !link.hasAttribute("target")
            ) {
                link.addEventListener("click", function (e) {
                    e.preventDefault();
                    document.body.style.opacity = 0;
                    setTimeout(function () {
                        window.location = href;
                    }, 300); // ä¸ transition æ—¶é—´ä¸€è‡´
                });
            }
        });
    });

    // å¤„ç†æµè§ˆå™¨è¿”å›æ—¶çš„æ·¡å…¥ï¼ˆå¦‚åé€€æŒ‰é’®ï¼‰
    window.addEventListener("pageshow", function (event) {
        // å¦‚æœæ˜¯ä» bfcache æ¢å¤ï¼Œåˆ™éœ€è¦æ‰‹åŠ¨æ·¡å…¥
        if (event.persisted) {
            fadeIn();
        }
    });

</script>
</body>
</html>